{% extends "auctions/layout.html" %}

{% block title %}Auctions | {{ product.title }} {% endblock %}


{% block body %}
    <h2>{{ product.title }}</h2>
    {% if user.is_authenticated %}
        {% if watchlist %}
            <form action="{{product.id}}/remove">
                <input type="submit" value="Remove from Watchlist" />
            </form>
        {% else %}
            <form action="{{product.id}}/add">
                <input type="submit" value="Add to Watchlist" />
            </form>
        {% endif %}
        {% if owner and open %}
            <form action="{{product.id}}/close">
                <input type="submit" value="Close Auction" />
            </form>
            
        {% endif %}

        {% if not open %}
            <p>Closed Auction</p>
        {% endif %}

    {% endif %}

    <img src={{product.image}}></img>
    <h3>{{product.price}}</h3>
    <ul>
        <li>Description: {{product.description}}</li>
        <li>Category: {{product.category}}</li>
        <li>Created: {{product.created}}</li>
    </ul>

    {% if bids and open %}
        <p>Currently {{ bids|length }} bid(s) so far.{% if last_bid %} You are the current bid.{% endif %}</p>
    {% endif %}

    

    {% if user.is_authenticated and open %}
        <form action="{{product.id}}/bid">
            <label for="price">Place a bid!</label>
            <input type="number" placeholder="Place your Bid..." min={{product.price}} max="999999.99" name="price">
            <input type="submit" value="Bid!" />
        </form>
    {% elif not user.is_authenticated  %}
        <p>Please <a href="{% url 'login' %}">Log In</a> to place a bid!</p>
    {% elif not open %}
        <p>
            Auction is closed!
            {% if winner %}
            Congratulations {{winner}} for winning the auction!
            {% endif %}
        </p>
    {% endif %}

    {% if user.is_authenticated %}
        <form method="POST">
        {% csrf_token %}
            <label for="comment">Leave a comment!</label>
            <textarea name="comment" placeholder="Nice Item!" rows="4" cols="50"></textarea>
            <input type="submit" value="Comment!" />
        </form>
    {% endif %}
    {% if comments %}
    <ul>
        {% for i in comments %}
        <li>{{i.comment}}</li>
        {% endfor %}
    </ul>
    {% endif %}
    
{% endblock %}